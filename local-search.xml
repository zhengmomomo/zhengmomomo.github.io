<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Camera_Calibration</title>
    <link href="/2024/06/07/Camera-Calibration/"/>
    <url>/2024/06/07/Camera-Calibration/</url>
    
    <content type="html"><![CDATA[<h3 id="相机标定之四个坐标系"><a href="#相机标定之四个坐标系" class="headerlink" title="相机标定之四个坐标系"></a>相机标定之四个坐标系</h3><h4 id="一、四大坐标系简述"><a href="#一、四大坐标系简述" class="headerlink" title="一、四大坐标系简述"></a>一、四大坐标系简述</h4><img src="/2024/06/07/Camera-Calibration/00_four_axis.png" class=""><ul><li>世界坐标系：就是身处的世界</li><li>相机坐标系：相机光心（感光芯片的中心）为坐标原点</li><li>成像坐标系：焦点为坐标原点，与相机坐标系距离一个焦距，单位是毫米</li><li>像素坐标系：以图像左上角为坐标原点，单位是像素</li></ul><img src="/2024/06/07/Camera-Calibration/01.png" class=""><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">物体（世界坐标系）     透镜（相机坐标系）      成像平面（成像/像素坐标系）</span><br>  <span class="hljs-comment">|                  |                     |</span><br>  <span class="hljs-comment">|</span>&lt;<span class="hljs-literal">------</span> <span class="hljs-comment">f</span> <span class="hljs-literal">------</span>&gt;<span class="hljs-comment">光心</span>&lt;<span class="hljs-literal">------</span> <span class="hljs-comment">f</span> <span class="hljs-literal">------</span>&gt;<span class="hljs-comment">|焦点</span>&lt;<span class="hljs-literal">------</span> <span class="hljs-comment">f</span> <span class="hljs-literal">------</span>&gt;<span class="hljs-comment">|</span><br></code></pre></td></tr></table></figure><h4 id="二、四大坐标系转换"><a href="#二、四大坐标系转换" class="headerlink" title="二、四大坐标系转换"></a>二、四大坐标系转换</h4><p>主要思路：要将像素坐标系下的某个二维点，先转换到成像坐标系，再转换到相机坐标系，最后成世界坐标系下的一个三维点。</p><p>相机标定的目的：是为了知道二维图像上的一个点或者物体相对于拍摄主体的位置</p><p><strong>1. 像素坐标系到成像坐标系的转换</strong></p><p>两坐标系的位置关系如下图所示，像素坐标系为$O_p-(u,v)$ ，成像坐标系为$O_i-(x,y)$，转换基于以下两条实现：</p><p>a. 成像坐标系的坐标原点为焦点，在像素坐标系下的坐标为$(u_0,v_0)$​ </p><p>b. 已知$dx,dy$​分别表示一个像素物理x方向和y方向的长度</p><img src="/2024/06/07/Camera-Calibration/02.png" class=""><p>转换关系为：</p><img src="/2024/06/07/Camera-Calibration/03.png" class=""><p><strong>2.成像坐标系到相机坐标系的转换</strong></p><p>两坐标系的位置关系如下图所示，成像坐标系为$o-(x,y)$，相机坐标系为$O_C-(X_C,Y_C,Z_C)$，转换基于以下关系：</p><p>a. 光心与焦点之间的距离为焦距$f$</p><p>b.三角形 $O_coC$ 与三角形 $O_CAB$ 相似、三角形 $O_CPC$ 与三角形 $O_CBP$ 相似</p><img src="/2024/06/07/Camera-Calibration/04.png" class=""><p>转换关系为：</p><img src="/2024/06/07/Camera-Calibration/05.png" class=""><p><strong>3.相机坐标系到世界坐标系的转换</strong></p><p>两坐标系的位置关系如下图所示，相机坐标系为$O_C-(X_C,Y_C,Z_C)$，世界坐标系 $O_W-(X_W,Y_W,Z_W)$​ 转换基于以下关系：</p><p>a.转换由平移变换和旋转变换组成 ，如下图 R 为旋转矩阵，T 为平移向量</p><img src="/2024/06/07/Camera-Calibration/06.png" class=""><p><strong>平移变换</strong>，假设相机坐标点 $(X_C, Y_C,Z_C)$ 平移 $(t_x, t_y, t_z)$ 到世界坐标点$(X_W,Y_W,Z_W)$​​ ，有：</p><img src="/2024/06/07/Camera-Calibration/07.png" class=""><h1 id="旋转变换，即假设分别围绕x轴、y轴、z轴旋转α-β-γ-度数，总的旋转矩阵为，从左往右依次代表沿z轴，沿y轴和沿x轴旋转-left-begin-array-l-mathrm-X-W-mathrm-Y-W-mathrm-Z-W-1-end-array-right-left-begin-array-cccc-cos-gamma-sin-gamma-0-0-sin-gamma-cos-gamma-0-0-0-0-1-0-0-0-0-1-end-array-right-left-begin-array-cccc-cos-beta-0-sin-beta-0-0-1-0-0-sin-beta-0-cos-beta-0-0-0-0-1-end-array-right-left-begin-array-cccc-1-0-0-0-0-cos-alpha-sin-alpha-0-0-sin-alpha-cos-alpha-0-0-0-0-1-end-array-right-left-begin-array-l-mathrm-X-C-mathrm-Y-C-mathrm-Z-C-1-end-array-right-旋转平移变换的总的形式可以写成如下：-begin-bmatrix-X-W-Y-W-Z-W-1-end-bmatrix"><a href="#旋转变换，即假设分别围绕x轴、y轴、z轴旋转α-β-γ-度数，总的旋转矩阵为，从左往右依次代表沿z轴，沿y轴和沿x轴旋转-left-begin-array-l-mathrm-X-W-mathrm-Y-W-mathrm-Z-W-1-end-array-right-left-begin-array-cccc-cos-gamma-sin-gamma-0-0-sin-gamma-cos-gamma-0-0-0-0-1-0-0-0-0-1-end-array-right-left-begin-array-cccc-cos-beta-0-sin-beta-0-0-1-0-0-sin-beta-0-cos-beta-0-0-0-0-1-end-array-right-left-begin-array-cccc-1-0-0-0-0-cos-alpha-sin-alpha-0-0-sin-alpha-cos-alpha-0-0-0-0-1-end-array-right-left-begin-array-l-mathrm-X-C-mathrm-Y-C-mathrm-Z-C-1-end-array-right-旋转平移变换的总的形式可以写成如下：-begin-bmatrix-X-W-Y-W-Z-W-1-end-bmatrix" class="headerlink" title="旋转变换，即假设分别围绕x轴、y轴、z轴旋转α, β , γ  度数，总的旋转矩阵为，从左往右依次代表沿z轴，沿y轴和沿x轴旋转$$\left[\begin{array}{l}\mathrm{X_W} \\mathrm{Y_W} \\mathrm{Z_W} \1\end{array}\right]&#x3D;\left[\begin{array}{cccc}\cos \gamma &amp; -\sin \gamma &amp; 0 &amp; 0 \\sin \gamma &amp; \cos \gamma &amp; 0 &amp; 0 \0 &amp; 0 &amp; 1 &amp; 0 \0 &amp; 0 &amp; 0 &amp; 1\end{array}\right]\left[\begin{array}{cccc}\cos \beta &amp; 0 &amp; \sin \beta &amp; 0 \0 &amp; 1 &amp; 0 &amp; 0 \-\sin \beta &amp; 0 &amp; \cos \beta &amp; 0 \0 &amp; 0 &amp; 0 &amp; 1\end{array}\right]\left[\begin{array}{cccc}1 &amp; 0 &amp; 0 &amp; 0 \0 &amp; \cos \alpha &amp; -\sin \alpha &amp; 0 \0 &amp; \sin \alpha &amp; \cos \alpha &amp; 0 \0 &amp; 0 &amp; 0 &amp; 1\end{array}\right]\left[\begin{array}{l}\mathrm{X_C} \\mathrm{Y_C} \\mathrm{Z_C} \1\end{array}\right]$$旋转平移变换的总的形式可以写成如下：$$\begin{bmatrix}X_W \Y_W \Z_W \1\end{bmatrix} "></a><strong>旋转变换</strong>，即假设分别围绕x轴、y轴、z轴旋转α, β , γ  度数，总的旋转矩阵为，从左往右依次代表沿z轴，沿y轴和沿x轴旋转<br>$$<br>\left[\begin{array}{l}<br>\mathrm{X_W} \<br>\mathrm{Y_W} \<br>\mathrm{Z_W} \<br>1<br>\end{array}\right]&#x3D;\left[\begin{array}{cccc}<br>\cos \gamma &amp; -\sin \gamma &amp; 0 &amp; 0 \<br>\sin \gamma &amp; \cos \gamma &amp; 0 &amp; 0 \<br>0 &amp; 0 &amp; 1 &amp; 0 \<br>0 &amp; 0 &amp; 0 &amp; 1<br>\end{array}\right]\left[\begin{array}{cccc}<br>\cos \beta &amp; 0 &amp; \sin \beta &amp; 0 \<br>0 &amp; 1 &amp; 0 &amp; 0 \<br>-\sin \beta &amp; 0 &amp; \cos \beta &amp; 0 \<br>0 &amp; 0 &amp; 0 &amp; 1<br>\end{array}\right]\left[\begin{array}{cccc}<br>1 &amp; 0 &amp; 0 &amp; 0 \<br>0 &amp; \cos \alpha &amp; -\sin \alpha &amp; 0 \<br>0 &amp; \sin \alpha &amp; \cos \alpha &amp; 0 \<br>0 &amp; 0 &amp; 0 &amp; 1<br>\end{array}\right]\left[\begin{array}{l}<br>\mathrm{X_C} \<br>\mathrm{Y_C} \<br>\mathrm{Z_C} \<br>1<br>\end{array}\right]<br>$$<br><strong>旋转平移变换的总的形式</strong>可以写成如下：<br>$$<br>\begin{bmatrix}<br>X_W \<br>Y_W \<br>Z_W \<br>1<br>\end{bmatrix} </h1><p>\begin{bmatrix}<br>R  &amp; T\<br>0  &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br> X_C\<br> Y_C\<br> Z_C\<br>1<br>\end{bmatrix}<br>$$<br>其中：<br>$$<br>T &#x3D; \begin{bmatrix}<br>t_x \<br>t_y \<br>t_z<br>\end{bmatrix}<br>$$</p><h1 id="R-R-xR-yR-z"><a href="#R-R-xR-yR-z" class="headerlink" title="$$R&#x3D;R_xR_yR_z "></a>$$<br>R&#x3D;R_xR_yR_z </h1><p>\left[\begin{array}{cccc}<br>1 &amp; 0 &amp; 0  \<br>0 &amp; \cos \alpha &amp; -\sin \alpha  \<br>0 &amp; \sin \alpha &amp; \cos \alpha  \</p><p>\end{array}\right]<br>\left[\begin{array}{cccc}<br>\cos \beta &amp; 0 &amp; \sin \beta \<br>0 &amp; 1 &amp; 0  \<br>-\sin \beta &amp; 0 &amp; \cos \beta  \<br>\end{array}\right]</p><p>\left[\begin{array}{cccc}<br>\cos \gamma &amp; -\sin \gamma &amp; 0  \<br>\sin \gamma &amp; \cos \gamma &amp; 0  \<br>0 &amp; 0 &amp; 1  \<br>\end{array}\right]<br>$$</p><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>像素坐标系到世界坐标系的变换<br>$$<br>\begin{bmatrix}X_w\Y_w\Z_w\1\end{bmatrix}&#x3D;\boxed{\begin{bmatrix}R&amp;T\0&amp;1\end{bmatrix}}\boxed{\begin{bmatrix}\frac{Z_cdx}{f}&amp;0&amp;\frac{-Z_cu_0dx}{f}\0&amp;\frac{Z_cdy}{f}&amp;\frac{-Z_cv_0dy}{f}\0&amp;0&amp;Z_c\0&amp;0&amp;1\end{bmatrix}}\begin{bmatrix}u\v\1\end{bmatrix}<br>$$</p><p>左边框内为<strong>外参</strong>，右边框内为<strong>内参</strong></p><p>内参是相机固有的属性，实际上就是焦距f、像元尺寸dx,dy以及Zc<br>Zc很明显，表示的是点离光轴的距离。</p><h1 id="公式备份-left-begin-array-l-x-udx-u-0-dx-y-vdy-v-0-dy-end-array-right-转换成齐次矩阵形式：-begin-bmatrix-x-y-1-end-bmatrix"><a href="#公式备份-left-begin-array-l-x-udx-u-0-dx-y-vdy-v-0-dy-end-array-right-转换成齐次矩阵形式：-begin-bmatrix-x-y-1-end-bmatrix" class="headerlink" title="公式备份$$\left{\begin{array}{l}x&#x3D;udx-u_0 dx \y&#x3D;vdy-v_0 dy\end{array}\right.$$转换成齐次矩阵形式：$$\begin{bmatrix} x\ y\1\end{bmatrix}"></a><em><strong>公式备份</strong></em><br>$$<br>\left{<br>\begin{array}{l}<br>x&#x3D;udx-u_0 dx \<br>y&#x3D;vdy-v_0 dy<br>\end{array}\right.<br>$$<br>转换成齐次矩阵形式：<br>$$<br>\begin{bmatrix}<br> x\<br> y\<br>1<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>dx &amp; 0  &amp; -u_0dx \<br>0  &amp; dy &amp; -v_0dy \<br>0  &amp; 0  &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>u\<br>v\<br>1<br>\end{bmatrix}<br>$$</p><p>$$<br>\left{<br>\begin{array}{l}<br>X_C&#x3D; \frac{Z_C}{f}x \<br>Y_C&#x3D;\frac{Z_C}{f}y \<br>Z_C &#x3D; Z_C<br>\end{array}\right.<br>$$</p><h1 id="转换为齐次矩阵形式为-begin-bmatrix-X-C-Y-C-Z-C-end-bmatrix"><a href="#转换为齐次矩阵形式为-begin-bmatrix-X-C-Y-C-Z-C-end-bmatrix" class="headerlink" title="转换为齐次矩阵形式为$$\begin{bmatrix} X_C\ Y_C\ Z_C\end{bmatrix}"></a>转换为齐次矩阵形式为<br>$$<br>\begin{bmatrix}<br> X_C\<br> Y_C\<br> Z_C<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>\frac{Z_C}{f} &amp; 0  &amp; 0 \<br>0  &amp; \frac{Z_C}{f} &amp; 0 \<br>0  &amp; 0  &amp; Z_C<br>\end{bmatrix}<br>\begin{bmatrix}<br>x\<br>y\<br>1<br>\end{bmatrix}<br>$$</p><h1 id="left-begin-array-l-X-W-X-C-t-x-Y-W-Y-C-t-y-Z-W-Z-C-t-z-end-array-right-写成矩阵形式即-begin-bmatrix-X-W-Y-W-Z-W-1-end-bmatrix"><a href="#left-begin-array-l-X-W-X-C-t-x-Y-W-Y-C-t-y-Z-W-Z-C-t-z-end-array-right-写成矩阵形式即-begin-bmatrix-X-W-Y-W-Z-W-1-end-bmatrix" class="headerlink" title="$$\left{\begin{array}{l}X_W &#x3D; X_C + t_x \Y_W &#x3D; Y_C + t_y \Z_W &#x3D; Z_C + t_z\end{array}\right.$$写成矩阵形式即$$\begin{bmatrix} X_W\ Y_W\ Z_W\ 1\end{bmatrix}"></a>$$<br>\left{<br>\begin{array}{l}<br>X_W &#x3D; X_C + t_x \<br>Y_W &#x3D; Y_C + t_y \<br>Z_W &#x3D; Z_C + t_z<br>\end{array}\right.<br>$$<br>写成矩阵形式即<br>$$<br>\begin{bmatrix}<br> X_W\<br> Y_W\<br> Z_W\<br> 1<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>1 &amp; 0  &amp; 0 &amp; t_x \<br>0  &amp; 1 &amp; 0 &amp; t_y \<br>0  &amp; 0  &amp; 1 &amp; t_z \<br>0 &amp;  0 &amp; 0 &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>X_C\<br>Y_C\<br>Z_C \<br>1<br>\end{bmatrix}<br>$$</p>]]></content>
    
    
    
    <tags>
      
      <tag>Tech Article</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>testlog</title>
    <link href="/2024/06/05/testlog/"/>
    <url>/2024/06/05/testlog/</url>
    
    <content type="html"><![CDATA[<p>This is a test log.</p><img src="/2024/06/05/testlog/testimg.jpg" class="" title="This is an example image">]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
